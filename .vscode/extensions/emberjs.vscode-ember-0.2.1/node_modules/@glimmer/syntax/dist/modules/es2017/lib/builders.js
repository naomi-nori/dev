import * as AST from './types/nodes';
function buildMustache(path, params, hash, raw, loc) {
    if (!AST.isLiteral(path)) {
        path = buildPath(path);
    }
    return {
        type: 'MustacheStatement',
        path,
        params: params || [],
        hash: hash || buildHash([]),
        escaped: !raw,
        loc: buildLoc(loc || null)
    };
}
function buildBlock(path, params, hash, program, inverse, loc) {
    return {
        type: 'BlockStatement',
        path: buildPath(path),
        params: params || [],
        hash: hash || buildHash([]),
        program: program || null,
        inverse: inverse || null,
        loc: buildLoc(loc || null)
    };
}
function buildElementModifier(path, params, hash, loc) {
    return {
        type: 'ElementModifierStatement',
        path: buildPath(path),
        params: params || [],
        hash: hash || buildHash([]),
        loc: buildLoc(loc || null)
    };
}
function buildPartial(name, params, hash, indent, loc) {
    return {
        type: 'PartialStatement',
        name: name,
        params: params || [],
        hash: hash || buildHash([]),
        indent: indent || '',
        strip: { open: false, close: false },
        loc: buildLoc(loc || null)
    };
}
function buildComment(value, loc) {
    return {
        type: 'CommentStatement',
        value: value,
        loc: buildLoc(loc || null)
    };
}
function buildMustacheComment(value, loc) {
    return {
        type: 'MustacheCommentStatement',
        value: value,
        loc: buildLoc(loc || null)
    };
}
function buildConcat(parts, loc) {
    return {
        type: 'ConcatStatement',
        parts: parts || [],
        loc: buildLoc(loc || null)
    };
}
function buildElement(tag, attributes, modifiers, children, comments, loc) {
    // this is used for backwards compat prior to `comments` being added to the AST
    if (!Array.isArray(comments)) {
        loc = comments;
        comments = [];
    }
    // this is used for backwards compat, prior to `selfClosing` being part of the ElementNode AST
    let selfClosing = false;
    if (typeof tag === 'object') {
        selfClosing = tag.selfClosing;
        tag = tag.name;
    }
    return {
        type: 'ElementNode',
        tag: tag || '',
        selfClosing: selfClosing,
        attributes: attributes || [],
        blockParams: [],
        modifiers: modifiers || [],
        comments: comments || [],
        children: children || [],
        loc: buildLoc(loc || null)
    };
}
function buildAttr(name, value, loc) {
    return {
        type: 'AttrNode',
        name: name,
        value: value,
        loc: buildLoc(loc || null)
    };
}
function buildText(chars, loc) {
    return {
        type: 'TextNode',
        chars: chars || '',
        loc: buildLoc(loc || null)
    };
}
// Expressions
function buildSexpr(path, params, hash, loc) {
    return {
        type: 'SubExpression',
        path: buildPath(path),
        params: params || [],
        hash: hash || buildHash([]),
        loc: buildLoc(loc || null)
    };
}
function buildPath(original, loc) {
    if (typeof original !== 'string') return original;
    let parts = original.split('.');
    let thisHead = false;
    if (parts[0] === 'this') {
        thisHead = true;
        parts = parts.slice(1);
    }
    return {
        type: 'PathExpression',
        original,
        this: thisHead,
        parts,
        data: false,
        loc: buildLoc(loc || null)
    };
}
function buildLiteral(type, value, loc) {
    return {
        type,
        value,
        original: value,
        loc: buildLoc(loc || null)
    };
}
// Miscellaneous
function buildHash(pairs, loc) {
    return {
        type: 'Hash',
        pairs: pairs || [],
        loc: buildLoc(loc || null)
    };
}
function buildPair(key, value, loc) {
    return {
        type: 'HashPair',
        key: key,
        value,
        loc: buildLoc(loc || null)
    };
}
function buildProgram(body, blockParams, loc) {
    return {
        type: 'Program',
        body: body || [],
        blockParams: blockParams || [],
        loc: buildLoc(loc || null)
    };
}
function buildSource(source) {
    return source || null;
}
function buildPosition(line, column) {
    return {
        line,
        column
    };
}
export const SYNTHETIC = {
    source: '(synthetic)',
    start: { line: 1, column: 0 },
    end: { line: 1, column: 0 }
};
function buildLoc(...args) {
    if (args.length === 1) {
        let loc = args[0];
        if (loc && typeof loc === 'object') {
            return {
                source: buildSource(loc.source),
                start: buildPosition(loc.start.line, loc.start.column),
                end: buildPosition(loc.end.line, loc.end.column)
            };
        } else {
            return SYNTHETIC;
        }
    } else {
        let [startLine, startColumn, endLine, endColumn, source] = args;
        return {
            source: buildSource(source),
            start: buildPosition(startLine, startColumn),
            end: buildPosition(endLine, endColumn)
        };
    }
}
export default {
    mustache: buildMustache,
    block: buildBlock,
    partial: buildPartial,
    comment: buildComment,
    mustacheComment: buildMustacheComment,
    element: buildElement,
    elementModifier: buildElementModifier,
    attr: buildAttr,
    text: buildText,
    sexpr: buildSexpr,
    path: buildPath,
    concat: buildConcat,
    hash: buildHash,
    pair: buildPair,
    literal: buildLiteral,
    program: buildProgram,
    loc: buildLoc,
    pos: buildPosition,
    string: literal('StringLiteral'),
    boolean: literal('BooleanLiteral'),
    number: literal('NumberLiteral'),
    undefined() {
        return buildLiteral('UndefinedLiteral', undefined);
    },
    null() {
        return buildLiteral('NullLiteral', null);
    }
};
function literal(type) {
    return function (value) {
        return buildLiteral(type, value);
    };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnVpbGRlcnMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9wYWNrYWdlcy9AZ2xpbW1lci9zeW50YXgvbGliL2J1aWxkZXJzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sS0FBSyxBQUFHLFNBQU0sQUFBZSxBQUFDO0FBUXJDLHVCQUNFLEFBQStCLE1BQy9CLEFBQXlCLFFBQ3pCLEFBQWUsTUFDZixBQUFhLEtBQ2IsQUFBd0I7QUFFeEIsUUFBSSxDQUFDLEFBQUcsSUFBQyxBQUFTLFVBQUMsQUFBSSxBQUFDLE9BQUU7QUFDeEIsQUFBSSxlQUFHLEFBQVMsVUFBQyxBQUFJLEFBQUMsQUFBQztBQUN4QjtBQUVEO0FBQ0UsQUFBSSxjQUFFLEFBQW1CO0FBQ3pCLEFBQUk7QUFDSixBQUFNLGdCQUFFLEFBQU0sVUFBSSxBQUFFO0FBQ3BCLEFBQUksY0FBRSxBQUFJLFFBQUksQUFBUyxVQUFDLEFBQUUsQUFBQztBQUMzQixBQUFPLGlCQUFFLENBQUMsQUFBRztBQUNiLEFBQUcsYUFBRSxBQUFRLFNBQUMsQUFBRyxPQUFJLEFBQUksQUFBQyxBQUMzQixBQUFDLEFBQ0o7QUFSUztBQVFSO0FBRUQsb0JBQ0UsQUFBaUIsTUFDakIsQUFBZ0MsUUFDaEMsQUFBc0IsTUFDdEIsQUFBb0IsU0FDcEIsQUFBNkIsU0FDN0IsQUFBd0I7QUFFeEI7QUFDRSxBQUFJLGNBQUUsQUFBZ0I7QUFDdEIsQUFBSSxjQUFFLEFBQVMsVUFBQyxBQUFJLEFBQUM7QUFDckIsQUFBTSxnQkFBRSxBQUFNLFVBQUksQUFBRTtBQUNwQixBQUFJLGNBQUUsQUFBSSxRQUFJLEFBQVMsVUFBQyxBQUFFLEFBQUM7QUFDM0IsQUFBTyxpQkFBRSxBQUFPLFdBQUksQUFBSTtBQUN4QixBQUFPLGlCQUFFLEFBQU8sV0FBSSxBQUFJO0FBQ3hCLEFBQUcsYUFBRSxBQUFRLFNBQUMsQUFBRyxPQUFJLEFBQUksQUFBQyxBQUMzQixBQUFDLEFBQ0o7QUFUUztBQVNS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RSxBQUFRLGNBQUUsQUFBYTtBQUN2QixBQUFLLFdBQUUsQUFBVTtBQUNqQixBQUFPLGFBQUUsQUFBWTtBQUNyQixBQUFPLGFBQUUsQUFBWTtBQUNyQixBQUFlLHFCQUFFLEFBQW9CO0FBQ3JDLEFBQU8sYUFBRSxBQUFZO0FBQ3JCLEFBQWUscUJBQUUsQUFBb0I7QUFDckMsQUFBSSxVQUFFLEFBQVM7QUFDZixBQUFJLFVBQUUsQUFBUztBQUNmLEFBQUssV0FBRSxBQUFVO0FBQ2pCLEFBQUksVUFBRSxBQUFTO0FBQ2YsQUFBTSxZQUFFLEFBQVc7QUFDbkIsQUFBSSxVQUFFLEFBQVM7QUFDZixBQUFJLFVBQUUsQUFBUztBQUNmLEFBQU8sYUFBRSxBQUFZO0FBQ3JCLEFBQU8sYUFBRSxBQUFZO0FBQ3JCLEFBQUcsU0FBRSxBQUFRO0FBQ2IsQUFBRyxTQUFFLEFBQWE7QUFFbEIsQUFBTSxZQUFFLEFBQU8sUUFBQyxBQUFlLEFBQUM7QUFDaEMsQUFBTyxhQUFFLEFBQU8sUUFBQyxBQUFnQixBQUFDO0FBQ2xDLEFBQU0sWUFBRSxBQUFPLFFBQUMsQUFBZSxBQUFDO0FBQ2hDLEFBQVM7QUFDUCxlQUFPLEFBQVksYUFBQyxBQUFrQixvQkFBRSxBQUFTLEFBQUMsQUFBQyxBQUNyRDtBQUFDO0FBQ0QsQUFBSTtBQUNGLGVBQU8sQUFBWSxhQUFDLEFBQWEsZUFBRSxBQUFJLEFBQUMsQUFBQyxBQUMzQztBQUFDLEFBQ0YsQUFBQztBQTdCYTtBQStCZixpQkFBd0MsQUFBZTtBQUNyRCxXQUFPLFVBQVMsQUFBaUI7QUFDL0IsZUFBTyxBQUFZLGFBQUMsQUFBSSxNQUFFLEFBQUssQUFBQyxBQUFDLEFBQ25DO0FBQUMsQUFBQyxBQUNKO0FBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBBU1QgZnJvbSAnLi90eXBlcy9ub2Rlcyc7XG5pbXBvcnQgeyBPcHRpb24gfSBmcm9tICdAZ2xpbW1lci9pbnRlcmZhY2VzJztcblxuLy8gU3RhdGVtZW50c1xuXG5leHBvcnQgdHlwZSBCdWlsZGVyUGF0aCA9IHN0cmluZyB8IEFTVC5QYXRoRXhwcmVzc2lvbjtcbmV4cG9ydCB0eXBlIFRhZ0Rlc2NyaXB0b3IgPSBzdHJpbmcgfCB7IG5hbWU6IHN0cmluZzsgc2VsZkNsb3Npbmc6IGJvb2xlYW4gfTtcblxuZnVuY3Rpb24gYnVpbGRNdXN0YWNoZShcbiAgcGF0aDogQnVpbGRlclBhdGggfCBBU1QuTGl0ZXJhbCxcbiAgcGFyYW1zPzogQVNULkV4cHJlc3Npb25bXSxcbiAgaGFzaD86IEFTVC5IYXNoLFxuICByYXc/OiBib29sZWFuLFxuICBsb2M/OiBBU1QuU291cmNlTG9jYXRpb25cbik6IEFTVC5NdXN0YWNoZVN0YXRlbWVudCB7XG4gIGlmICghQVNULmlzTGl0ZXJhbChwYXRoKSkge1xuICAgIHBhdGggPSBidWlsZFBhdGgocGF0aCk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHR5cGU6ICdNdXN0YWNoZVN0YXRlbWVudCcsXG4gICAgcGF0aCxcbiAgICBwYXJhbXM6IHBhcmFtcyB8fCBbXSxcbiAgICBoYXNoOiBoYXNoIHx8IGJ1aWxkSGFzaChbXSksXG4gICAgZXNjYXBlZDogIXJhdyxcbiAgICBsb2M6IGJ1aWxkTG9jKGxvYyB8fCBudWxsKSxcbiAgfTtcbn1cblxuZnVuY3Rpb24gYnVpbGRCbG9jayhcbiAgcGF0aDogQnVpbGRlclBhdGgsXG4gIHBhcmFtczogT3B0aW9uPEFTVC5FeHByZXNzaW9uW10+LFxuICBoYXNoOiBPcHRpb248QVNULkhhc2g+LFxuICBwcm9ncmFtOiBBU1QuUHJvZ3JhbSxcbiAgaW52ZXJzZT86IE9wdGlvbjxBU1QuUHJvZ3JhbT4sXG4gIGxvYz86IEFTVC5Tb3VyY2VMb2NhdGlvblxuKTogQVNULkJsb2NrU3RhdGVtZW50IHtcbiAgcmV0dXJuIHtcbiAgICB0eXBlOiAnQmxvY2tTdGF0ZW1lbnQnLFxuICAgIHBhdGg6IGJ1aWxkUGF0aChwYXRoKSxcbiAgICBwYXJhbXM6IHBhcmFtcyB8fCBbXSxcbiAgICBoYXNoOiBoYXNoIHx8IGJ1aWxkSGFzaChbXSksXG4gICAgcHJvZ3JhbTogcHJvZ3JhbSB8fCBudWxsLFxuICAgIGludmVyc2U6IGludmVyc2UgfHwgbnVsbCxcbiAgICBsb2M6IGJ1aWxkTG9jKGxvYyB8fCBudWxsKSxcbiAgfTtcbn1cblxuZnVuY3Rpb24gYnVpbGRFbGVtZW50TW9kaWZpZXIoXG4gIHBhdGg6IEJ1aWxkZXJQYXRoLFxuICBwYXJhbXM/OiBBU1QuRXhwcmVzc2lvbltdLFxuICBoYXNoPzogQVNULkhhc2gsXG4gIGxvYz86IE9wdGlvbjxBU1QuU291cmNlTG9jYXRpb24+XG4pOiBBU1QuRWxlbWVudE1vZGlmaWVyU3RhdGVtZW50IHtcbiAgcmV0dXJuIHtcbiAgICB0eXBlOiAnRWxlbWVudE1vZGlmaWVyU3RhdGVtZW50JyxcbiAgICBwYXRoOiBidWlsZFBhdGgocGF0aCksXG4gICAgcGFyYW1zOiBwYXJhbXMgfHwgW10sXG4gICAgaGFzaDogaGFzaCB8fCBidWlsZEhhc2goW10pLFxuICAgIGxvYzogYnVpbGRMb2MobG9jIHx8IG51bGwpLFxuICB9O1xufVxuXG5mdW5jdGlvbiBidWlsZFBhcnRpYWwoXG4gIG5hbWU6IEFTVC5QYXRoRXhwcmVzc2lvbixcbiAgcGFyYW1zPzogQVNULkV4cHJlc3Npb25bXSxcbiAgaGFzaD86IEFTVC5IYXNoLFxuICBpbmRlbnQ/OiBzdHJpbmcsXG4gIGxvYz86IEFTVC5Tb3VyY2VMb2NhdGlvblxuKTogQVNULlBhcnRpYWxTdGF0ZW1lbnQge1xuICByZXR1cm4ge1xuICAgIHR5cGU6ICdQYXJ0aWFsU3RhdGVtZW50JyxcbiAgICBuYW1lOiBuYW1lLFxuICAgIHBhcmFtczogcGFyYW1zIHx8IFtdLFxuICAgIGhhc2g6IGhhc2ggfHwgYnVpbGRIYXNoKFtdKSxcbiAgICBpbmRlbnQ6IGluZGVudCB8fCAnJyxcbiAgICBzdHJpcDogeyBvcGVuOiBmYWxzZSwgY2xvc2U6IGZhbHNlIH0sXG4gICAgbG9jOiBidWlsZExvYyhsb2MgfHwgbnVsbCksXG4gIH07XG59XG5cbmZ1bmN0aW9uIGJ1aWxkQ29tbWVudCh2YWx1ZTogc3RyaW5nLCBsb2M/OiBBU1QuU291cmNlTG9jYXRpb24pOiBBU1QuQ29tbWVudFN0YXRlbWVudCB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogJ0NvbW1lbnRTdGF0ZW1lbnQnLFxuICAgIHZhbHVlOiB2YWx1ZSxcbiAgICBsb2M6IGJ1aWxkTG9jKGxvYyB8fCBudWxsKSxcbiAgfTtcbn1cblxuZnVuY3Rpb24gYnVpbGRNdXN0YWNoZUNvbW1lbnQoXG4gIHZhbHVlOiBzdHJpbmcsXG4gIGxvYz86IEFTVC5Tb3VyY2VMb2NhdGlvblxuKTogQVNULk11c3RhY2hlQ29tbWVudFN0YXRlbWVudCB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogJ011c3RhY2hlQ29tbWVudFN0YXRlbWVudCcsXG4gICAgdmFsdWU6IHZhbHVlLFxuICAgIGxvYzogYnVpbGRMb2MobG9jIHx8IG51bGwpLFxuICB9O1xufVxuXG5mdW5jdGlvbiBidWlsZENvbmNhdChcbiAgcGFydHM6IChBU1QuVGV4dE5vZGUgfCBBU1QuTXVzdGFjaGVTdGF0ZW1lbnQpW10sXG4gIGxvYz86IEFTVC5Tb3VyY2VMb2NhdGlvblxuKTogQVNULkNvbmNhdFN0YXRlbWVudCB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogJ0NvbmNhdFN0YXRlbWVudCcsXG4gICAgcGFydHM6IHBhcnRzIHx8IFtdLFxuICAgIGxvYzogYnVpbGRMb2MobG9jIHx8IG51bGwpLFxuICB9O1xufVxuXG4vLyBOb2Rlc1xuXG5mdW5jdGlvbiBidWlsZEVsZW1lbnQoXG4gIHRhZzogVGFnRGVzY3JpcHRvcixcbiAgYXR0cmlidXRlcz86IEFTVC5BdHRyTm9kZVtdLFxuICBtb2RpZmllcnM/OiBBU1QuRWxlbWVudE1vZGlmaWVyU3RhdGVtZW50W10sXG4gIGNoaWxkcmVuPzogQVNULlN0YXRlbWVudFtdLFxuICBsb2M/OiBBU1QuU291cmNlTG9jYXRpb25cbik6IEFTVC5FbGVtZW50Tm9kZTtcbmZ1bmN0aW9uIGJ1aWxkRWxlbWVudChcbiAgdGFnOiBUYWdEZXNjcmlwdG9yLFxuICBhdHRyaWJ1dGVzPzogQVNULkF0dHJOb2RlW10sXG4gIG1vZGlmaWVycz86IEFTVC5FbGVtZW50TW9kaWZpZXJTdGF0ZW1lbnRbXSxcbiAgY2hpbGRyZW4/OiBBU1QuU3RhdGVtZW50W10sXG4gIGNvbW1lbnRzPzogQVNULk11c3RhY2hlQ29tbWVudFN0YXRlbWVudFtdLFxuICBsb2M/OiBBU1QuU291cmNlTG9jYXRpb25cbik6IEFTVC5FbGVtZW50Tm9kZTtcblxuZnVuY3Rpb24gYnVpbGRFbGVtZW50KFxuICB0YWc6IFRhZ0Rlc2NyaXB0b3IsXG4gIGF0dHJpYnV0ZXM/OiBBU1QuQXR0ck5vZGVbXSxcbiAgbW9kaWZpZXJzPzogQVNULkVsZW1lbnRNb2RpZmllclN0YXRlbWVudFtdLFxuICBjaGlsZHJlbj86IEFTVC5TdGF0ZW1lbnRbXSxcbiAgY29tbWVudHM/OiBBU1QuTXVzdGFjaGVDb21tZW50U3RhdGVtZW50W10gfCBBU1QuU291cmNlTG9jYXRpb24sXG4gIGxvYz86IEFTVC5Tb3VyY2VMb2NhdGlvblxuKTogQVNULkVsZW1lbnROb2RlIHtcbiAgLy8gdGhpcyBpcyB1c2VkIGZvciBiYWNrd2FyZHMgY29tcGF0IHByaW9yIHRvIGBjb21tZW50c2AgYmVpbmcgYWRkZWQgdG8gdGhlIEFTVFxuICBpZiAoIUFycmF5LmlzQXJyYXkoY29tbWVudHMpKSB7XG4gICAgbG9jID0gY29tbWVudHM7XG4gICAgY29tbWVudHMgPSBbXTtcbiAgfVxuXG4gIC8vIHRoaXMgaXMgdXNlZCBmb3IgYmFja3dhcmRzIGNvbXBhdCwgcHJpb3IgdG8gYHNlbGZDbG9zaW5nYCBiZWluZyBwYXJ0IG9mIHRoZSBFbGVtZW50Tm9kZSBBU1RcbiAgbGV0IHNlbGZDbG9zaW5nID0gZmFsc2U7XG4gIGlmICh0eXBlb2YgdGFnID09PSAnb2JqZWN0Jykge1xuICAgIHNlbGZDbG9zaW5nID0gdGFnLnNlbGZDbG9zaW5nO1xuICAgIHRhZyA9IHRhZy5uYW1lO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICB0eXBlOiAnRWxlbWVudE5vZGUnLFxuICAgIHRhZzogdGFnIHx8ICcnLFxuICAgIHNlbGZDbG9zaW5nOiBzZWxmQ2xvc2luZyxcbiAgICBhdHRyaWJ1dGVzOiBhdHRyaWJ1dGVzIHx8IFtdLFxuICAgIGJsb2NrUGFyYW1zOiBbXSxcbiAgICBtb2RpZmllcnM6IG1vZGlmaWVycyB8fCBbXSxcbiAgICBjb21tZW50czogY29tbWVudHMgfHwgW10sXG4gICAgY2hpbGRyZW46IGNoaWxkcmVuIHx8IFtdLFxuICAgIGxvYzogYnVpbGRMb2MobG9jIHx8IG51bGwpLFxuICB9O1xufVxuXG5mdW5jdGlvbiBidWlsZEF0dHIoXG4gIG5hbWU6IHN0cmluZyxcbiAgdmFsdWU6IEFTVC5BdHRyTm9kZVsndmFsdWUnXSxcbiAgbG9jPzogQVNULlNvdXJjZUxvY2F0aW9uXG4pOiBBU1QuQXR0ck5vZGUge1xuICByZXR1cm4ge1xuICAgIHR5cGU6ICdBdHRyTm9kZScsXG4gICAgbmFtZTogbmFtZSxcbiAgICB2YWx1ZTogdmFsdWUsXG4gICAgbG9jOiBidWlsZExvYyhsb2MgfHwgbnVsbCksXG4gIH07XG59XG5cbmZ1bmN0aW9uIGJ1aWxkVGV4dChjaGFycz86IHN0cmluZywgbG9jPzogQVNULlNvdXJjZUxvY2F0aW9uKTogQVNULlRleHROb2RlIHtcbiAgcmV0dXJuIHtcbiAgICB0eXBlOiAnVGV4dE5vZGUnLFxuICAgIGNoYXJzOiBjaGFycyB8fCAnJyxcbiAgICBsb2M6IGJ1aWxkTG9jKGxvYyB8fCBudWxsKSxcbiAgfTtcbn1cblxuLy8gRXhwcmVzc2lvbnNcblxuZnVuY3Rpb24gYnVpbGRTZXhwcihcbiAgcGF0aDogQnVpbGRlclBhdGgsXG4gIHBhcmFtcz86IEFTVC5FeHByZXNzaW9uW10sXG4gIGhhc2g/OiBBU1QuSGFzaCxcbiAgbG9jPzogQVNULlNvdXJjZUxvY2F0aW9uXG4pOiBBU1QuU3ViRXhwcmVzc2lvbiB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogJ1N1YkV4cHJlc3Npb24nLFxuICAgIHBhdGg6IGJ1aWxkUGF0aChwYXRoKSxcbiAgICBwYXJhbXM6IHBhcmFtcyB8fCBbXSxcbiAgICBoYXNoOiBoYXNoIHx8IGJ1aWxkSGFzaChbXSksXG4gICAgbG9jOiBidWlsZExvYyhsb2MgfHwgbnVsbCksXG4gIH07XG59XG5cbmZ1bmN0aW9uIGJ1aWxkUGF0aChvcmlnaW5hbDogQnVpbGRlclBhdGgsIGxvYz86IEFTVC5Tb3VyY2VMb2NhdGlvbik6IEFTVC5QYXRoRXhwcmVzc2lvbiB7XG4gIGlmICh0eXBlb2Ygb3JpZ2luYWwgIT09ICdzdHJpbmcnKSByZXR1cm4gb3JpZ2luYWw7XG5cbiAgbGV0IHBhcnRzID0gb3JpZ2luYWwuc3BsaXQoJy4nKTtcbiAgbGV0IHRoaXNIZWFkID0gZmFsc2U7XG5cbiAgaWYgKHBhcnRzWzBdID09PSAndGhpcycpIHtcbiAgICB0aGlzSGVhZCA9IHRydWU7XG4gICAgcGFydHMgPSBwYXJ0cy5zbGljZSgxKTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgdHlwZTogJ1BhdGhFeHByZXNzaW9uJyxcbiAgICBvcmlnaW5hbCxcbiAgICB0aGlzOiB0aGlzSGVhZCxcbiAgICBwYXJ0cyxcbiAgICBkYXRhOiBmYWxzZSxcbiAgICBsb2M6IGJ1aWxkTG9jKGxvYyB8fCBudWxsKSxcbiAgfTtcbn1cblxuZnVuY3Rpb24gYnVpbGRMaXRlcmFsPFQgZXh0ZW5kcyBBU1QuTGl0ZXJhbD4oXG4gIHR5cGU6IFRbJ3R5cGUnXSxcbiAgdmFsdWU6IFRbJ3ZhbHVlJ10sXG4gIGxvYz86IEFTVC5Tb3VyY2VMb2NhdGlvblxuKTogQVNULkxpdGVyYWwge1xuICByZXR1cm4ge1xuICAgIHR5cGUsXG4gICAgdmFsdWUsXG4gICAgb3JpZ2luYWw6IHZhbHVlLFxuICAgIGxvYzogYnVpbGRMb2MobG9jIHx8IG51bGwpLFxuICB9IGFzIEFTVC5MaXRlcmFsO1xufVxuXG4vLyBNaXNjZWxsYW5lb3VzXG5cbmZ1bmN0aW9uIGJ1aWxkSGFzaChwYWlycz86IEFTVC5IYXNoUGFpcltdLCBsb2M/OiBBU1QuU291cmNlTG9jYXRpb24pOiBBU1QuSGFzaCB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogJ0hhc2gnLFxuICAgIHBhaXJzOiBwYWlycyB8fCBbXSxcbiAgICBsb2M6IGJ1aWxkTG9jKGxvYyB8fCBudWxsKSxcbiAgfTtcbn1cblxuZnVuY3Rpb24gYnVpbGRQYWlyKGtleTogc3RyaW5nLCB2YWx1ZTogQVNULkV4cHJlc3Npb24sIGxvYz86IEFTVC5Tb3VyY2VMb2NhdGlvbik6IEFTVC5IYXNoUGFpciB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogJ0hhc2hQYWlyJyxcbiAgICBrZXk6IGtleSxcbiAgICB2YWx1ZSxcbiAgICBsb2M6IGJ1aWxkTG9jKGxvYyB8fCBudWxsKSxcbiAgfTtcbn1cblxuZnVuY3Rpb24gYnVpbGRQcm9ncmFtKFxuICBib2R5PzogQVNULlN0YXRlbWVudFtdLFxuICBibG9ja1BhcmFtcz86IHN0cmluZ1tdLFxuICBsb2M/OiBBU1QuU291cmNlTG9jYXRpb25cbik6IEFTVC5Qcm9ncmFtIHtcbiAgcmV0dXJuIHtcbiAgICB0eXBlOiAnUHJvZ3JhbScsXG4gICAgYm9keTogYm9keSB8fCBbXSxcbiAgICBibG9ja1BhcmFtczogYmxvY2tQYXJhbXMgfHwgW10sXG4gICAgbG9jOiBidWlsZExvYyhsb2MgfHwgbnVsbCksXG4gIH07XG59XG5cbmZ1bmN0aW9uIGJ1aWxkU291cmNlKHNvdXJjZT86IHN0cmluZykge1xuICByZXR1cm4gc291cmNlIHx8IG51bGw7XG59XG5cbmZ1bmN0aW9uIGJ1aWxkUG9zaXRpb24obGluZTogbnVtYmVyLCBjb2x1bW46IG51bWJlcikge1xuICByZXR1cm4ge1xuICAgIGxpbmUsXG4gICAgY29sdW1uLFxuICB9O1xufVxuXG5leHBvcnQgY29uc3QgU1lOVEhFVElDOiBBU1QuU291cmNlTG9jYXRpb24gPSB7XG4gIHNvdXJjZTogJyhzeW50aGV0aWMpJyxcbiAgc3RhcnQ6IHsgbGluZTogMSwgY29sdW1uOiAwIH0sXG4gIGVuZDogeyBsaW5lOiAxLCBjb2x1bW46IDAgfSxcbn07XG5cbmZ1bmN0aW9uIGJ1aWxkTG9jKGxvYzogT3B0aW9uPEFTVC5Tb3VyY2VMb2NhdGlvbj4pOiBBU1QuU291cmNlTG9jYXRpb247XG5mdW5jdGlvbiBidWlsZExvYyhcbiAgc3RhcnRMaW5lOiBudW1iZXIsXG4gIHN0YXJ0Q29sdW1uOiBudW1iZXIsXG4gIGVuZExpbmU/OiBudW1iZXIsXG4gIGVuZENvbHVtbj86IG51bWJlcixcbiAgc291cmNlPzogc3RyaW5nXG4pOiBBU1QuU291cmNlTG9jYXRpb247XG5cbmZ1bmN0aW9uIGJ1aWxkTG9jKC4uLmFyZ3M6IGFueVtdKTogQVNULlNvdXJjZUxvY2F0aW9uIHtcbiAgaWYgKGFyZ3MubGVuZ3RoID09PSAxKSB7XG4gICAgbGV0IGxvYyA9IGFyZ3NbMF07XG5cbiAgICBpZiAobG9jICYmIHR5cGVvZiBsb2MgPT09ICdvYmplY3QnKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzb3VyY2U6IGJ1aWxkU291cmNlKGxvYy5zb3VyY2UpLFxuICAgICAgICBzdGFydDogYnVpbGRQb3NpdGlvbihsb2Muc3RhcnQubGluZSwgbG9jLnN0YXJ0LmNvbHVtbiksXG4gICAgICAgIGVuZDogYnVpbGRQb3NpdGlvbihsb2MuZW5kLmxpbmUsIGxvYy5lbmQuY29sdW1uKSxcbiAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBTWU5USEVUSUM7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGxldCBbc3RhcnRMaW5lLCBzdGFydENvbHVtbiwgZW5kTGluZSwgZW5kQ29sdW1uLCBzb3VyY2VdID0gYXJncztcbiAgICByZXR1cm4ge1xuICAgICAgc291cmNlOiBidWlsZFNvdXJjZShzb3VyY2UpLFxuICAgICAgc3RhcnQ6IGJ1aWxkUG9zaXRpb24oc3RhcnRMaW5lLCBzdGFydENvbHVtbiksXG4gICAgICBlbmQ6IGJ1aWxkUG9zaXRpb24oZW5kTGluZSwgZW5kQ29sdW1uKSxcbiAgICB9O1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgbXVzdGFjaGU6IGJ1aWxkTXVzdGFjaGUsXG4gIGJsb2NrOiBidWlsZEJsb2NrLFxuICBwYXJ0aWFsOiBidWlsZFBhcnRpYWwsXG4gIGNvbW1lbnQ6IGJ1aWxkQ29tbWVudCxcbiAgbXVzdGFjaGVDb21tZW50OiBidWlsZE11c3RhY2hlQ29tbWVudCxcbiAgZWxlbWVudDogYnVpbGRFbGVtZW50LFxuICBlbGVtZW50TW9kaWZpZXI6IGJ1aWxkRWxlbWVudE1vZGlmaWVyLFxuICBhdHRyOiBidWlsZEF0dHIsXG4gIHRleHQ6IGJ1aWxkVGV4dCxcbiAgc2V4cHI6IGJ1aWxkU2V4cHIsXG4gIHBhdGg6IGJ1aWxkUGF0aCxcbiAgY29uY2F0OiBidWlsZENvbmNhdCxcbiAgaGFzaDogYnVpbGRIYXNoLFxuICBwYWlyOiBidWlsZFBhaXIsXG4gIGxpdGVyYWw6IGJ1aWxkTGl0ZXJhbCxcbiAgcHJvZ3JhbTogYnVpbGRQcm9ncmFtLFxuICBsb2M6IGJ1aWxkTG9jLFxuICBwb3M6IGJ1aWxkUG9zaXRpb24sXG5cbiAgc3RyaW5nOiBsaXRlcmFsKCdTdHJpbmdMaXRlcmFsJyksXG4gIGJvb2xlYW46IGxpdGVyYWwoJ0Jvb2xlYW5MaXRlcmFsJyksXG4gIG51bWJlcjogbGl0ZXJhbCgnTnVtYmVyTGl0ZXJhbCcpLFxuICB1bmRlZmluZWQoKSB7XG4gICAgcmV0dXJuIGJ1aWxkTGl0ZXJhbCgnVW5kZWZpbmVkTGl0ZXJhbCcsIHVuZGVmaW5lZCk7XG4gIH0sXG4gIG51bGwoKSB7XG4gICAgcmV0dXJuIGJ1aWxkTGl0ZXJhbCgnTnVsbExpdGVyYWwnLCBudWxsKTtcbiAgfSxcbn07XG5cbmZ1bmN0aW9uIGxpdGVyYWw8VCBleHRlbmRzIEFTVC5MaXRlcmFsPih0eXBlOiBUWyd0eXBlJ10pIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKHZhbHVlOiBUWyd2YWx1ZSddKSB7XG4gICAgcmV0dXJuIGJ1aWxkTGl0ZXJhbCh0eXBlLCB2YWx1ZSk7XG4gIH07XG59XG4iXX0=